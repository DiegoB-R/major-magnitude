---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout>
  <span slot="title">My space — PrimerPaso</span>

  <main class="container">
    <section class="hero card dashboard-hero">
      <div class="dashboard-row">
        <div class="dashboard-left">
          <h1 id="welcomeName">Welcome, student</h1>
          <p class="muted">This is your personal space. See your applications, saved jobs and complete your profile so companies can find you.</p>
          <div class="hero-ctas">
            <a class="btn large warm" href="/jobs">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
              <span>Explore jobs</span>
            </a>
            <a class="btn outline" href="/perfiluser">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
              <span>Edit profile</span>
            </a>
          </div>
        </div>

        <aside class="dashboard-right">
          <div class="profile-card card">
            <div class="avatar" id="avatar"></div>
            <div class="profile-info">
              <h3 id="studentName">Student</h3>
              <p class="muted small" id="studentUni">University</p>
            </div>
              <a class="btn full primary" href="/perfiluser">Complete profile</a>
            <a class="btn ghost full" href="#savedJobs" style="margin-top:8px">View saved jobs</a>
          </div>
        </aside>
      </div>
    </section>

    <section class="section dashboard-grid">
      <div class="container grid-areas">
        <div class="card">
          <h4>Saved jobs</h4>
          <ul id="savedJobs" style="margin-top:8px"></ul>
        </div>
        <div class="card">
          <h4>Recent activity</h4>
          <ol id="recentActivity" style="margin-top:8px">
            <li>No recent activity — start searching for jobs.</li>
          </ol>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Fill student name and saved jobs from localStorage (demo)
    (() => {
      try{
        const raw = localStorage.getItem('primerpaso_student');
        if(raw){
          const s = JSON.parse(raw);
          const name = (s.firstName || '') + (s.lastName ? (' ' + s.lastName) : '');
          document.getElementById('studentName').textContent = name || 'Student';
          document.getElementById('welcomeName').textContent = name ? `Welcome, ${name}` : 'Welcome, student';
          if(s.firstName) document.getElementById('avatar').textContent = s.firstName.charAt(0).toUpperCase() + (s.lastName ? s.lastName.charAt(0).toUpperCase() : '');
          if(s.email) document.getElementById('studentUni').textContent = s.email;
        }
      }catch(e){console.warn('No student data', e)}

      // render saved jobs demo if any
      try{
        const saved = JSON.parse(localStorage.getItem('primerpaso_saved_jobs') || '[]');
        const ul = document.getElementById('savedJobs');
        if(ul){
          ul.innerHTML = saved.length ? saved.map(j=>`<li>${j.title} — ${j.company}</li>`).join('') : '<li>You don\'t have any saved jobs yet.</li>';
        }
      }catch(e){ }
    })();
  </script>

  <style>
    /* Dashboard layout refinements */
    .dashboard-hero{padding:24px}
    .dashboard-row{display:flex;gap:24px;align-items:flex-start}
    .dashboard-left{flex:1}
    .dashboard-right{width:320px}
    .profile-card{display:flex;flex-direction:column;align-items:center;padding:18px;gap:10px}
    .profile-card .avatar{width:72px;height:72px;border-radius:12px;background:linear-gradient(135deg,var(--terracota,#7c1d11),var(--morado,#4b2b88));color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:20px}
    .profile-info{width:100%;text-align:center}
    .hero-ctas{display:flex;gap:12px;margin-top:16px}
    .hero-ctas .btn { display: inline-flex; align-items: center; gap: 8px; }
    .btn.outline{background:transparent;border:2px solid rgba(11,23,39,0.06);color:var(--morado,#4b2b88);padding:10px 14px;border-radius:8px}

    .dashboard-grid .grid-areas{display:grid;grid-template-columns:1fr 1fr;gap:28px;margin-top:28px}
    @media (max-width:900px){
      .dashboard-row{flex-direction:column}
      .dashboard-right{width:100%}
      .dashboard-grid .grid-areas{grid-template-columns:1fr}
    }
  </style>
</BaseLayout>
